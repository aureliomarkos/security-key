<!DOCTYPE html>
<html class="dark" lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Security Key Mobile</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f77c18",
                        "background-light": "#f8f7f5",
                        "background-dark": "#140f0a",
                        "card-dark": "#231c14",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "1rem",
                        "lg": "2rem",
                        "xl": "3rem",
                        "full": "9999px",
                        "custom": "24px"
                    },
                },
            },
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #4b5563;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .material-symbols-outlined.filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        body {
            min-height: 100dvh;
        }

        .modal-backdrop {
            backdrop-filter: blur(4px);
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Fix for dark mode dropdown options contrast */
        .dark select option {
            background-color: #1e1b18;
            color: rgba(255, 255, 255, 0.8);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white font-display antialiased selection:bg-primary/30">

    <!-- LOGIN SCREEN MOBILE -->
    <div id="loginScreen"
        class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-background-light dark:bg-background-dark p-6">
        <div class="w-full max-w-sm">
            <div class="flex flex-col items-center mb-10">
                <div class="size-20 rounded-[24px] bg-primary/10 flex items-center justify-center mb-6">
                    <span class="material-symbols-outlined text-primary text-5xl">lock</span>
                </div>
                <h1 class="text-3xl font-black text-slate-900 dark:text-white">Security Key</h1>
                <p class="text-slate-500 dark:text-gray-400 text-sm mt-2">Cofre Digital Familiar</p>
            </div>

            <form id="loginForm" class="space-y-4">
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold ml-1 text-slate-700 dark:text-white/80">Email</label>
                    <input type="email" id="loginEmail" required
                        class="w-full px-5 py-4 rounded-custom bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                        placeholder="seu@email.com" />
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold ml-1 text-slate-700 dark:text-white/80">Senha</label>
                    <input type="password" id="loginPassword" required
                        class="w-full px-5 py-4 rounded-custom bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                        placeholder="••••••••" />
                </div>
                <div id="loginError" class="hidden text-red-500 text-sm text-center font-medium"></div>
                <button type="submit"
                    class="w-full bg-primary hover:bg-[#e0690a] text-white py-4 rounded-custom font-bold transition-all shadow-lg shadow-primary/20 active:scale-[0.98] mt-4">
                    Entrar
                </button>
            </form>

            <div class="mt-8 text-center">
                <button onclick="showRegister()" class="text-primary font-semibold">Criar nova conta</button>
            </div>
        </div>
    </div>

    <!-- REGISTER MODAL MOBILE -->
    <div id="registerModal"
        class="fixed inset-0 z-50 hidden flex-col items-center justify-center bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm p-6">
        <div class="w-full max-w-sm fade-in">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-bold">Criar Conta</h2>
                <button onclick="hideRegister()"
                    class="size-10 rounded-full bg-slate-100 dark:bg-white/5 flex items-center justify-center">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <form id="registerForm" class="space-y-4">
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold ml-1">Nome</label>
                    <input type="text" id="registerName" required
                        class="w-full px-5 py-4 rounded-custom bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                        placeholder="Seu nome" />
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold ml-1 text-slate-700 dark:text-white/80">Email</label>
                    <input type="email" id="registerEmail" required
                        class="w-full px-5 py-4 rounded-custom bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                        placeholder="seu@email.com" />
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold ml-1 text-slate-700 dark:text-white/80">Senha</label>
                    <input type="password" id="registerPassword" required minlength="6"
                        class="w-full px-5 py-4 rounded-custom bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                        placeholder="Mínimo 6 caracteres" />
                </div>
                <div id="registerError" class="hidden text-red-500 text-sm text-center font-medium"></div>
                <button type="submit"
                    class="w-full bg-primary hover:bg-[#e0690a] text-white py-4 rounded-custom font-bold transition-all shadow-lg shadow-primary/20 active:scale-[0.98] mt-4">
                    Criar Conta
                </button>
            </form>
        </div>
    </div>

    <!-- MAIN DASHBOARD MOBILE -->
    <div id="dashboard" class="hidden relative min-h-screen flex flex-col pb-24">

        <!-- Tab: Cofre -->
        <div id="tab-vault" class="flex flex-col flex-1">
            <header
                class="pt-14 pb-4 px-6 flex items-center justify-between sticky top-0 z-20 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm">
                <div>
                    <h1 class="text-2xl font-bold tracking-tight text-slate-900 dark:text-white">Security Key</h1>
                    <p class="text-xs font-medium text-slate-500 dark:text-white/60 mt-0.5">Bem-vindo de volta, <span
                            id="userNameHeader">...</span></p>
                </div>
                <button class="relative group" onclick="logout()">
                    <div
                        class="size-10 rounded-full bg-slate-200 dark:bg-card-dark flex items-center justify-center overflow-hidden border border-slate-300 dark:border-white/10 transition-transform active:scale-95">
                        <span class="material-symbols-outlined text-slate-600 dark:text-white/80">logout</span>
                    </div>
                </button>
            </header>

            <div class="px-6 mb-6">
                <!-- Search -->
                <div class="mb-4">
                    <div class="relative">
                        <span
                            class="absolute left-4 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-400">search</span>
                        <input id="searchInput" onkeyup="renderItems()"
                            class="w-full pl-11 pr-4 py-3 rounded-full bg-white dark:bg-card-dark border border-slate-200 dark:border-white/5 text-sm outline-none focus:ring-1 focus:ring-primary"
                            placeholder="Buscar itens..." type="text" />
                    </div>
                </div>

                <!-- Horizontal Categories -->
                <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2" id="categoriesNav">
                    <!-- Categories populated by JS -->
                </div>
            </div>

            <main class="flex-1 px-4 flex flex-col gap-3" id="itemsGrid">
                <!-- Items populated by JS -->
            </main>
        </div>

        <!-- Tab: Categorias -->
        <div id="tab-categories" class="hidden flex flex-col flex-1">
            <header class="pt-14 pb-6 px-6">
                <h1 class="text-2xl font-bold">Gerenciar Categorias</h1>
            </header>
            <div class="px-6 space-y-4" id="categoriesList">
                <!-- Detailed categories list for management -->
            </div>

            <div class="mt-8 px-6 pb-10">
                <button onclick="prepareNewCategory()"
                    class="w-full p-4 rounded-custom bg-primary/10 text-primary font-bold flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">add</span>
                    Nova Categoria
                </button>
            </div>
        </div>

        <!-- Tab: Configurações -->
        <div id="tab-settings" class="hidden flex flex-col flex-1">
            <header class="pt-14 pb-6 px-6">
                <h1 class="text-2xl font-bold">Configurações</h1>
            </header>
            <div class="px-6 space-y-6">
                <div
                    class="p-6 bg-white dark:bg-card-dark rounded-custom border border-slate-100 dark:border-white/5 shadow-sm">
                    <div class="flex items-center gap-4">
                        <div class="size-14 rounded-full bg-primary/10 flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined text-3xl">person</span>
                        </div>
                        <div>
                            <h3 id="userName" class="text-lg font-bold">...</h3>
                            <p id="userEmail" class="text-sm text-slate-500 dark:text-white/40">...</p>
                        </div>
                    </div>
                </div>

                <div class="space-y-2">
                    <button onclick="toggleTheme()"
                        class="w-full flex items-center justify-between p-5 bg-white dark:bg-card-dark rounded-custom border border-slate-100 dark:border-white/5 active:bg-slate-50 dark:active:bg-white/5 transition-colors">
                        <div class="flex items-center gap-4">
                            <span class="material-symbols-outlined text-slate-500" id="themeIcon">dark_mode</span>
                            <span class="font-semibold" id="themeText">Modo Escuro</span>
                        </div>
                        <span class="material-symbols-outlined text-slate-300">chevron_right</span>
                    </button>
                </div>

                <button onclick="logout()"
                    class="w-full flex items-center gap-4 p-5 text-red-500 font-bold active:bg-red-50 dark:active:bg-red-500/5 rounded-custom transition-colors">
                    <span class="material-symbols-outlined">logout</span>
                    Sair da Conta
                </button>
            </div>
        </div>

        <!-- FAB: Add Item -->
        <button id="fab-add" onclick="showItemModal()"
            class="fixed bottom-24 right-6 size-16 bg-primary rounded-full flex items-center justify-center shadow-xl shadow-primary/30 text-white z-30 active:scale-90 transition-transform">
            <span class="material-symbols-outlined" style="font-size: 32px;">add</span>
        </button>

        <!-- Bottom Navigation -->
        <nav
            class="fixed bottom-0 left-0 w-full h-[88px] bg-white/90 dark:bg-card-dark/90 backdrop-blur-md border-t border-slate-200 dark:border-white/5 z-40 pb-5">
            <div class="flex h-full items-center justify-around px-2">
                <button class="nav-btn flex flex-col items-center gap-1 p-2 w-20" data-tab="vault">
                    <div
                        class="nav-icon-container flex items-center justify-center size-10 rounded-full bg-primary/10 text-primary">
                        <span class="material-symbols-outlined filled">lock</span>
                    </div>
                    <span class="nav-text text-[11px] font-medium text-slate-900 dark:text-white">Cofre</span>
                </button>
                <button class="nav-btn flex flex-col items-center gap-1 p-2 w-20 group" data-tab="categories">
                    <div
                        class="nav-icon-container flex items-center justify-center size-10 rounded-full text-slate-400 dark:text-white/40 transition-colors">
                        <span class="material-symbols-outlined">category</span>
                    </div>
                    <span
                        class="nav-text text-[11px] font-medium text-slate-400 dark:text-white/40 transition-colors">Categorias</span>
                </button>
                <button class="nav-btn flex flex-col items-center gap-1 p-2 w-20 group" data-tab="settings">
                    <div
                        class="nav-icon-container flex items-center justify-center size-10 rounded-full text-slate-400 dark:text-white/40 transition-colors">
                        <span class="material-symbols-outlined">settings</span>
                    </div>
                    <span
                        class="nav-text text-[11px] font-medium text-slate-400 dark:text-white/40 transition-colors">Ajustes</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- ITEM MODAL MOBILE -->
    <div id="itemModal" class="fixed inset-0 z-[60] hidden bg-black/50 modal-backdrop p-4">
        <div
            class="w-full max-w-lg bg-white dark:bg-card-dark rounded-custom shadow-2xl p-6 fade-in max-h-[90vh] overflow-y-auto mt-10">
            <div class="flex items-center justify-between mb-6 sticky top-0 bg-inherit z-10 py-2">
                <h2 id="itemModalTitle" class="text-xl font-bold">Novo Item</h2>
                <button onclick="hideItemModal()" class="text-slate-400"><span
                        class="material-symbols-outlined">close</span></button>
            </div>
            <form id="itemForm" class="space-y-4 pb-4">
                <input type="hidden" id="itemId" />
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold">Título</label>
                    <input type="text" id="itemTitulo" required
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"
                        placeholder="Ex: Banco Itaú" />
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-1.5">
                        <label class="text-sm font-semibold">Categoria</label>
                        <select id="itemCategoria"
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"></select>
                    </div>
                    <div class="flex items-center gap-2 pt-6">
                        <input type="checkbox" id="itemFavorito"
                            class="size-5 rounded border-slate-300 text-primary focus:ring-primary" />
                        <label class="text-sm font-medium">Favorito</label>
                    </div>
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold">Notas</label>
                    <textarea id="itemNota" rows="2"
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"
                        placeholder="Observações..."></textarea>
                </div>

                <div class="border-t border-slate-100 dark:border-white/5 pt-4">
                    <div class="flex items-center justify-between mb-3 text-sm font-semibold">
                        <span>Campos</span>
                        <button type="button" onclick="addField()" class="text-primary flex items-center gap-1">
                            <span class="material-symbols-outlined text-lg">add</span> Adicionar
                        </button>
                    </div>
                    <div id="fieldsContainer" class="space-y-3"></div>
                </div>

                <div class="flex gap-3 pt-6 sticky bottom-0 bg-inherit py-2 border-t dark:border-white/5">
                    <button type="submit"
                        class="flex-1 bg-primary text-white py-4 rounded-xl font-bold shadow-lg shadow-primary/20">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- CATEGORY FORM MODAL MOBILE -->
    <div id="categoryModal" class="fixed inset-0 z-[60] hidden bg-black/50 modal-backdrop p-4">
        <div class="w-full max-w-sm bg-white dark:bg-card-dark rounded-custom shadow-2xl p-6 fade-in mt-20">
            <div class="flex items-center justify-between mb-6">
                <h2 id="categoryFormTitle" class="text-xl font-bold">Nova Categoria</h2>
                <button onclick="hideCategoryModal()" class="text-slate-400"><span
                        class="material-symbols-outlined">close</span></button>
            </div>
            <form id="categoryForm" class="space-y-4">
                <input type="hidden" id="catId" />
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold">Nome</label>
                    <input type="text" id="catNome" required
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"
                        placeholder="Ex: Viagens" />
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold">Ícone (Google Material)</label>
                    <div class="flex gap-2">
                        <input type="text" id="catIcone" required
                            class="flex-1 px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"
                            placeholder="Ex: flight" oninput="updateIconPreview()" />
                        <div id="iconPreview"
                            class="size-12 rounded-xl bg-slate-100 dark:bg-white/10 flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined">category</span>
                        </div>
                    </div>
                </div>
                <div class="space-y-1.5">
                    <label class="text-sm font-semibold">Cor</label>
                    <div class="flex items-center gap-3">
                        <input type="color" id="catCor"
                            class="size-12 rounded-full border-none bg-transparent cursor-pointer" value="#f77c18" />
                        <span id="colorHex" class="font-mono text-sm opacity-50">#f77c18</span>
                    </div>
                </div>
                <button type="submit"
                    class="w-full bg-primary text-white py-4 rounded-xl font-bold shadow-lg shadow-primary/20 mt-4">Salvar</button>
            </form>
        </div>
    </div>

    <!-- SHARE MODAL MOBILE -->
    <div id="shareModal" class="fixed inset-0 z-[60] hidden bg-black/50 modal-backdrop p-4 items-center justify-center">
        <div class="w-full max-w-sm bg-white dark:bg-card-dark rounded-custom shadow-2xl fade-in overflow-hidden">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold">Compartilhar</h2>
                    <button onclick="hideShareModal()" class="text-slate-400"><span
                            class="material-symbols-outlined">close</span></button>
                </div>

                <input type="hidden" id="shareItemId" />

                <div class="mb-2 space-y-3 max-h-40 overflow-y-auto no-scrollbar" id="sharedUsersList">
                    <!-- Shared users -->
                </div>
            </div>

            <!-- Adicionar usuário -->
            <div class="border-t border-slate-100 dark:border-white/5 p-6 space-y-4">
                <h3 class="text-sm font-bold text-slate-900 dark:text-white">Adicionar pessoa</h3>
                <div class="space-y-1.5">
                    <label class="text-xs font-semibold opacity-60">Pessoa</label>
                    <select id="shareUserSelect"
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary"></select>
                </div>
                <div class="space-y-1.5">
                    <label class="text-xs font-semibold opacity-60">Nível de Acesso</label>
                    <select id="shareAccessLevel"
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-200 dark:border-white/10 outline-none focus:ring-1 focus:ring-primary">
                        <option value="visualizar">Visualizar</option>
                        <option value="editar">Editar</option>
                    </select>
                </div>
                <button onclick="addShare()"
                    class="w-full bg-primary text-white py-4 rounded-xl font-bold shadow-lg shadow-primary/20">Compartilhar</button>
            </div>
        </div>
    </div>

    <script src="./static/app_mobile.js?v=13"></script>
</body>

</html>